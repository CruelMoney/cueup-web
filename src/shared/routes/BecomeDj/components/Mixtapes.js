import React, { useEffect, useState } from 'react';
import styled from 'styled-components';
import { useTranslation } from 'react-i18next';
import { NavLink } from 'react-router-dom';
import { Container, ReadMore } from 'components/Blocks';
import { appRoutes } from 'constants/locales/appRoutes';
import SoundBars from 'routes/User/routes/Sounds/SoundBars';
import useScanning from 'routes/User/routes/Sounds/useScanning';
import { Card } from './PaymentCards';
import { GrayText, Header } from './Text';
import { TextAccent } from './blocks/TextAccent';

const Bg = styled.div`
    display: flex;
    justify-content: center;
    width: 100%;
    z-index: 2;
    position: relative;
    margin-bottom: 30px;
`;

const SoundBarWrapper = styled.div`
    margin-bottom: 60px;
    margin-left: -38px;
    margin-right: -38px;
`;

const nikkiBeach = [
    71,
    71,
    70,
    63,
    71,
    72,
    75,
    78,
    79,
    80,
    60,
    79,
    79,
    78,
    77,
    70,
    67,
    73,
    62,
    62,
    78,
    76,
    78,
    78,
    78,
    77,
    79,
    75,
    78,
    70,
    63,
    68,
    57,
    53,
    48,
    45,
    46,
    47,
    46,
    48,
    47,
    49,
    51,
    52,
    54,
    56,
    55,
    56,
    51,
    51,
    51,
    49,
    53,
    53,
    51,
    59,
    53,
    57,
    54,
    54,
    55,
    52,
    53,
    51,
    50,
    47,
    48,
    47,
    47,
    45,
    45,
    50,
    54,
    60,
    62,
    60,
    63,
    63,
    63,
    62,
    60,
    59,
    62,
    63,
    63,
    62,
    64,
    63,
    64,
    63,
    63,
    59,
    59,
    52,
    54,
    53,
    57,
    60,
    62,
    60,
    61,
    60,
    61,
    73,
    73,
    71,
    49,
    55,
    69,
    59,
    78,
    78,
    77,
    76,
    75,
    80,
    78,
    77,
    65,
    68,
    62,
    61,
    79,
    79,
    77,
    77,
    79,
    78,
    77,
    76,
    77,
    47,
    47,
    56,
    69,
    78,
    78,
    75,
    75,
    78,
    68,
    59,
    59,
    52,
    57,
    56,
    57,
    59,
    57,
    57,
    56,
    58,
    56,
    57,
    56,
    56,
    50,
    57,
    47,
    46,
    46,
    48,
    46,
    56,
    56,
    56,
    54,
    54,
    49,
    57,
    62,
    70,
    66,
    66,
    77,
    86,
    73,
    78,
    72,
    77,
    78,
    84,
    84,
    83,
    80,
    78,
    73,
    76,
    74,
    73,
    77,
    81,
    91,
    82,
    82,
    78,
    80,
    78,
    71,
    71,
    71,
    72,
    74,
    74,
    78,
    77,
    77,
    75,
    76,
    75,
    72,
    34,
    37,
    46,
    49,
    34,
    45,
    70,
    74,
    75,
    78,
    78,
    80,
    78,
    72,
    75,
    78,
    79,
    71,
    67,
    66,
    60,
    65,
    65,
    69,
    75,
    74,
    74,
    74,
    74,
    72,
    71,
    76,
    78,
    77,
    76,
    75,
    76,
    72,
    74,
    72,
    64,
    62,
    60,
    66,
    77,
    77,
    77,
    77,
    75,
    75,
    72,
    74,
    72,
    72,
    74,
    75,
    75,
    75,
    72,
    72,
    65,
    60,
    63,
    67,
    69,
    71,
    67,
    66,
    67,
    60,
    64,
    66,
    65,
    55,
    47,
    46,
    44,
    50,
    46,
    49,
    71,
    71,
    71,
    75,
    70,
    69,
    66,
    65,
    63,
    65,
    77,
    77,
    69,
    76,
    77,
    80,
    77,
    76,
    77,
    77,
    85,
    81,
    83,
    74,
    81,
    83,
    85,
    80,
    78,
    79,
    80,
    79,
    82,
    82,
    87,
    84,
    86,
    68,
    80,
    82,
    80,
    86,
    79,
    79,
    80,
    84,
    76,
    74,
    83,
    77,
    80,
    86,
    84,
    87,
    91,
    93,
    86,
    90,
    90,
    88,
    89,
    90,
    91,
    92,
    93,
    95,
    93,
    96,
    96,
    93,
    89,
    87,
    87,
    91,
    92,
    93,
    100,
    98,
    90,
    94,
    94,
    91,
    89,
    88,
    86,
    79,
    75,
    77,
    75,
    83,
    81,
    77,
    81,
    78,
    77,
    81,
    82,
    81,
    81,
    81,
    81,
    84,
    83,
    56,
    35,
    51,
    53,
    80,
    81,
    79,
    83,
    83,
    83,
    81,
    77,
    69,
    65,
    64,
    60,
    59,
    62,
    60,
    65,
    60,
    63,
    69,
    65,
    52,
    41,
];
const track = [
    45,
    54,
    58,
    66,
    76,
    78,
    79,
    79,
    87,
    94,
    90,
    94,
    86,
    92,
    89,
    35,
    28,
    61,
    65,
    69,
    68,
    74,
    72,
    70,
    94,
    94,
    90,
    94,
    88,
    93,
    91,
    85,
    89,
    52,
    63,
    60,
    72,
    72,
    72,
    73,
    74,
    73,
    75,
    76,
    77,
    89,
    94,
    89,
    97,
    87,
    46,
    70,
    70,
    74,
    73,
    73,
    76,
    70,
    72,
    74,
    73,
    77,
    88,
    94,
    94,
    94,
    92,
    89,
    83,
    72,
    86,
    73,
    63,
    51,
    40,
    81,
    98,
    96,
    98,
    99,
    40,
    10,
    14,
    20,
    23,
    36,
    38,
    66,
    72,
    89,
    91,
    90,
    91,
    88,
    91,
    92,
    69,
    97,
    96,
    98,
    99,
    50,
    39,
    57,
    57,
    64,
    53,
    51,
    70,
    75,
    81,
    86,
    83,
    84,
    84,
    81,
    83,
    50,
    31,
    56,
    70,
    68,
    69,
    63,
    60,
    73,
    78,
    85,
    86,
    83,
    84,
    82,
    83,
    81,
    85,
    86,
    47,
    47,
    49,
    53,
    58,
    62,
    71,
    72,
    55,
    65,
    85,
    87,
    83,
    89,
    77,
    44,
    62,
    65,
    72,
    72,
    78,
    77,
    77,
    71,
    74,
    91,
    89,
    89,
    91,
    64,
    61,
    76,
    80,
    70,
    86,
    89,
    87,
    79,
    92,
    94,
    97,
    98,
    98,
    93,
    93,
    94,
    98,
    98,
    77,
    72,
    83,
    90,
    79,
    82,
    93,
    96,
    97,
    99,
    95,
    93,
    94,
    96,
    98,
    95,
    60,
    56,
    60,
    51,
    65,
    68,
    76,
    75,
    66,
    83,
    82,
    74,
    98,
    99,
    66,
    55,
    70,
    74,
    84,
    72,
    76,
    82,
    83,
    83,
    99,
    98,
    98,
    96,
    90,
    80,
    40,
    30,
    32,
    47,
    76,
    74,
    96,
    97,
    92,
    77,
    79,
    94,
    90,
    98,
    91,
    89,
    87,
    49,
    76,
    73,
    86,
    90,
    96,
    100,
    85,
    56,
    87,
    86,
    67,
    87,
    93,
    92,
    100,
    90,
    87,
    89,
    41,
    10,
    45,
    74,
    90,
    89,
    63,
    41,
    47,
    47,
    50,
    54,
    59,
    64,
    72,
    93,
    96,
    94,
    96,
    94,
    38,
    25,
    40,
    42,
    47,
    51,
    52,
    56,
    60,
    64,
    75,
    96,
    96,
    96,
    97,
    94,
    88,
    86,
    88,
    83,
    28,
    48,
    64,
    79,
    89,
    91,
    82,
    77,
    84,
    89,
    95,
    96,
    87,
    50,
    54,
    51,
    60,
    71,
    74,
    49,
    87,
    88,
    91,
    79,
    77,
    82,
    89,
    93,
    93,
    92,
    96,
    96,
    91,
    54,
    55,
    53,
    42,
    68,
    68,
    45,
    44,
    51,
    52,
    68,
    85,
    71,
    59,
    57,
    62,
    64,
    78,
    78,
    70,
    63,
    65,
    61,
    61,
    82,
    83,
    62,
    62,
    71,
    80,
    80,
    83,
    79,
    81,
    83,
    78,
    83,
    82,
    84,
    81,
    85,
    83,
    79,
    85,
    75,
    69,
    61,
    36,
    42,
    50,
    53,
    65,
    84,
    90,
    92,
    91,
    90,
    90,
    83,
    71,
    75,
    77,
    84,
    84,
    88,
    83,
    89,
    87,
    90,
    91,
    89,
    91,
    87,
    89,
    89,
    89,
    89,
    87,
    88,
    55,
    51,
];

const getSamples = (ss) =>
    Array.from({ length: 420 }, (_, idx) =>
        Math.max(Math.abs(Math.round(Math.sin(idx / ss) * 120)), 0)
    );

const samples = [getSamples(26.7), nikkiBeach, track];

const Mixtapes = () => {
    const { t } = useTranslation();

    const [idx, setIdx] = useState(0);

    useEffect(() => {
        const animation = setInterval(() => {
            setIdx((c) => (c === 2 ? 0 : c + 1));
        }, 2000);

        return () => clearInterval(animation);
    }, []);

    const { setScanningPosition, scanningPosition } = useScanning({
        duration: { totalSeconds: 3600 },
        loading: false,
        progress: 0,
    });

    return (
        <Bg>
            <Container>
                <Card>
                    <TextAccent center margin="0 0 15px 0">
                        THE SOUND OF YOU
                    </TextAccent>
                    <Header center mobileTextAlign="center" small>
                        Share your mixes
                    </Header>
                    <GrayText
                        style={{
                            textAlign: 'center',
                            maxWidth: 300,
                            margin: 'auto',
                            marginBottom: 30,
                        }}
                    >
                        Upload or share your mixes directly from SoundCloud.
                    </GrayText>
                    <NavLink
                        to={
                            t(appRoutes.blog) +
                            '/how-to-use-soundcloud-and-mixcloud-on-your-cueup-profile'
                        }
                        style={{ textAlign: 'center', marginBottom: '42px' }}
                    >
                        <ReadMore size="18px" uppercase={false}>
                            Read more
                        </ReadMore>
                    </NavLink>
                    <SoundBarWrapper>
                        <SoundBars
                            duration={{ totalSeconds: 3600 }}
                            samples={samples[idx]}
                            setScanningPosition={setScanningPosition}
                            scanningPosition={scanningPosition}
                        />
                    </SoundBarWrapper>
                </Card>
            </Container>
        </Bg>
    );
};

export default Mixtapes;
